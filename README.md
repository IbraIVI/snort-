# snort-


Snort هو نظام مفتوح المصدر لاكتشاف اختراق الشبكة وايضا نظام لمنع التطفل من اهم مميزاته مراقب حركة مرور الشبكة في الوقت الفعلي، Snort ايضا يمكن تخصيصه ليوافق متطلبات امان الشبكة الخاصة بك عن طريق وضع القواعد الصحيحة. 

لدى Snort أكثر من وضع للاستخدام: 

 : Packet loggingيستخدم لتسجيل حركة مرور الشبكة.
 : Packet sniffingيستخدم الالتقاط الحزم وتحليل حركة مرور الشبكة.

 : Intrusion detection system (IDS)يستخدم لرصد الأنشطة المشبوهة لحركة مرور الشبكة.

كيفية كتابة قاعدتك الخاصة؟
لكتابة قاعدتك الخاصة في Snort، يمكنك اتباع الخطوات التالية:
1.	قم بفتح ملف القواعد المخصص "local.rules" باستخدام محرر النصوص المفضل لديك. يمكن استخدام الأمر التالي في Vim لفتح الملف:
"sudo vim /etc/snort/rules/local.rules"
2.	بعد فتح الملف، يمكنك كتابة قاعدتك الخاصة. تتكون القواعد في Snort من عدة أجزاء، بما في ذلك:
•	الرأس (Header): يحدد نوع القاعدة ومعلومات أخرى مثل الأولوية والتصنيف.
•	الشرط (Condition): يحدد الشروط التي يجب تحقيقها لتنفيذ القاعدة.
•	الإجراء (Action): يحدد الإجراء الذي يتخذه Snort عند تطابق الحزمة مع الشرط.
3.	بعد كتابة القاعدة، قم بحفظ التغييرات في الملف.
4.	قم بإعادة تشغيل Snort. يمكن استخدام الأمر التالي:
"sudo service snort restart"
بعد ذلك، يجب أن تبدأ قاعدتك الخاصة في العمل وفقًا للشروط المحددة فيها.
 ![Picture1](https://github.com/ibrahim687/snort-/assets/47366177/b56ae0c8-4a20-4122-ac2c-2d680be5ed22)

سنستخدم هذا الأمر لبدء نظام كشف التسلل (IDS) باستخدام Snort:
"sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf"
1.	Sudo"" هو أمر لتشغيل الأمر التالي مع صلاحيات إدارية.
2.	"snort" هو الأمر الفعلي لبدء نظام كشف التسلل Snort.
3.	A"- "console يحدد أن Snort يجب أن يصدر تنبيهات إلى وحدة التحكم.
4.	""q- يخبر Snort بالعمل في وضع هادئ، مما يقلل من الإخراج غير الضروري.
5.	u" – "snort يحدد المستخدم الذي يجب أن يعمل Snort به (في هذه الحالة، "snort").
6.	g"– "snort يحدد المجموعة التي يجب أن يعمل Snort بها (في هذه الحالة ، "snort").
7.	"c /etc/snort/snort.conf-” يحدد موقع (conf file) الذي يجب أن يستخدمه Snort. في هذه الحالة، يوجد (conf file) في "/etc/snort/snort.conf".


لمحاكاة الهجوم، استخدمنا هذي الاداتين: Nmap وhping3:
•	Nmap هو أداة مجانية ومفتوحة المصدر يمكن استخدامها لفحص المنافذ على مضيف الهدف. يمكنه تحديد المنافذ المفتوحة، وتحديد نظام التشغيل للمضيف الهدف، واكتشاف نقاط الضعف الأمنية المختلفة.
•	hping3 هو أداة مجانية ومفتوحة لإنشاء حزم البيانات المخصصة التي يمكن إرسالها إلى جهاز الهدف. يمكن استخدامها لاختبار اتصال الشبكة لجهاز الهدف، وقياس وقت الاستجابة لاتصال الشبكة، وإرسال هجمات إنكار الخدمةDenial-of-Service (DoS) .
لاكتشاف ومراقبة حركة مرور الشبكة، استخدمنا Snort، وهو نظام كشف التسلل (IDS) مفتوح المصدر مجاني. يمكن لـ Snort اكتشاف مجموعة متنوعة من الهجمات، بما في ذلك هجمات فحص المنافذ، وهجمات DoS، وبرامج الفدية.
1.	Nmap <IP>
يستخدم هذا الأمر لتشغيل فحص Nmap على عنوان <IP> 
عن طريق تشغيل هذا الأمر، سيبدأ Nmap مسح عنوان<IP> الهدف وسيحاول تحديد المنافذ المفتوحة والخدمات التي تعمل على النظام.

2.	hping3 -c 5 -I 10 <IP>

يستخدم هذا الأمر لإرسال 5 حزم طلب صدى ICMP إلى عنوان. IP 
•	hping3" " هو الأمر لتشغيل أداة. hping3 
•	 "c- 5" يحدد عدد الحزم المراد إرسالها. في هذه الحالة، سوف يرسل5 "hping3" حزم.
•	 "I-10" يحدد الفاصل الزمني بين الحزم ، بالملي ثانية. في هذه الحالة، سوف ينتظر 10 "hping3" مللي ثانية بين كل حزمة.
•	 <IP> هو عنوان IP الهدف الذي سيتم إرسال الحزم إليه.




     : IPS - System Prevention Intrusion

نظام الوقاية من الاختراق في Snort هو عبارة عن وظيفة إضافية يمكن تكوينها ف Snort لتحويله من نظام كشف الاختراق (System Detection Intrusion IDS) إلى نظام يمكنه منع الهجمات أو تقليل تأثيراتها.



وضع inline يعني ان الحزم Packets تمر عبر snort بدال من تحو يلها الى snort وف هذا الوضع يمكن snort اسقاط packets واحباط محاولات الاستغلال الوقت في الوقت الفعلي في هذا الوضع يعمل snort كنظام IPS.

ولتفعيل نظام inline في Snort 

اذهب الى snort/etc/" " 

وابحث عن ملف conf.snort" "وعدل على 

Config daq: afpacket""

"Config daq_mode: inline"  تأكد من حذف علامة #.

عندما يعمل Snort كنظام IPS، فإنه يقوم بتحليل الشبكة بناء على قواعد محددة مسبق.
إذا تم اكتشاف هجوم محتمل أو سلوك غير مرغوب فيه، Snort يتخذ إجراءات فورية لمنع الهجوم أو تقليل تأثيراته.








